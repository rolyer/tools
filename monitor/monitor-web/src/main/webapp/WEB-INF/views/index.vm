<!DOCTYPE html>
<html>
<head>
	<title>Index</title>
	<script type="text/javascript" src="$link.getContextPath()/js/jquery-1.11.1.js"></script>
	<script type="text/javascript">
		var PATH = "$link.getContextPath()";
		
		$(document).ready(function(){
			load();
			
			$("#account").bind('keydown',function(e){
			      if(e.keyCode==13){
			    	  adduser();
			      }
		  	});
			
			$("button").click(function(){
				adduser()
			});
		});
		
		function adduser() {
			$.ajax({
				type : "POST",
				url : PATH + '/add.html?t=0.31572216271',
				data : {
					account : $('#account').val(),
					password : "123456"
				},
				dataType : "json",
				success : function(response, textStatus, xhr) {
					if (response.success) {
						load();
					}
				},
				error : function(xhr, textStatus, errorThrown) {}
			});
		}
		
		function load() {
			$.ajax({
				type : "POST",
				url : PATH + '/load.html',
				data : {},
				dataType : "json",
				success : function(response, textStatus, xhr) {
					if (response.success) {
						var datas = response.data;
            				$('#list').empty();
            			for ( var i in datas) {
            				$('#list').append("<li><a href='"+PATH+"/user_"+datas[i].id+".html'>UserId: "+datas[i].id+", Account: "+datas[i].account+"</a></li>");
            			}
					}
				},
				error : function(xhr, textStatus, errorThrown) {}
			});
		}
	</script>
</head>
<body>
	<h1>Monitor [Total: $!{total}]:</h1>
    <ol>
		#foreach($m in $monitors)
        	<li> name: ${m.name} running: ${m.running} path: ${m.file.path}</li>

		#end
	</ol>
</body>
</html>